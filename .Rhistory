res5 <- mod5 %>%
gather_draws(mu[t]) %>%
median_qi() %>%
mutate(year = years[t])
res_p5 <- mod5|>
gather_draws(mu_p[p])|>
median_qi()|>
mutate(year = years[nyears]+p)
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res5, aes(year, .value)) +
geom_ribbon(data = res5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p5, aes(year, .value), col = "red") +
geom_ribbon(data = res_p5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black")
ggplot(lka2, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res5, aes(year, .value)) +
geom_ribbon(data = res5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p5, aes(year, .value), col = "red") +
geom_ribbon(data = res_p5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black")
View(res_p5)
res5 <- mod5 %>%
gather_draws(mu[t]) %>%
median_qi() %>%
mutate(year = years2[t])
res_p5 <- mod5|>
gather_draws(mu_p[p])|>
median_qi()|>
mutate(year = years2[nyears2]+p)
ggplot(lka2, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res5, aes(year, .value)) +
geom_ribbon(data = res5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p5, aes(year, .value), col = "red") +
geom_ribbon(data = res_p5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res5, aes(year, .value)) +
geom_ribbon(data = res5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p5, aes(year, .value), col = "red") +
geom_ribbon(data = res_p5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res, aes(year, .value)) +
geom_line(data = res2, aes(year, .value), col="blue") +
geom_line(data = res_p2, aes(year, .value), col="blue") +
geom_line(data = res3, aes(year, .value), col = "red") +
geom_line(data = res_p3, aes(year, .value), col = "red") +
geom_line(data = res4, aes(year, .value), col = "green") +
geom_line(data = res_p4, aes(year, .value), col = "green") +
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black")
knitr::opts_chunk$set(echo = TRUE)
diff <- ear_temp - underarm_temp
ear_temp <- c(37.1, 36.2, 36.6, 37.4, 36.8, 36.7, 36.9, 37.4, 36.6, 36.7)
underarm_temp <- c(36.8, 36.6, 36.5, 37.0, 36.0, 36.5, 36.6, 37.1, 36.4, 36.7)
diff <- ear_temp - underarm_temp
mean(diff)
sd(diff)
knitr::opts_chunk$set(echo = TRUE)
pt(-1.94, 49)
library(tidyverse)
library(here)
library(rstan)
library(tidybayes)
lka <- read_csv(here("lka.csv"))
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka", y = "log ratio")
observed_years <- lka$year
years <- min(observed_years):max(observed_years)
nyears <- length(years)
stan_data <- list(y = lka$logit_ratio, year_i = observed_years - years[1]+1,
T = nyears, years = years, N = length(observed_years),
mid_year = mean(years), se = lka$se)
mod <- stan(data = stan_data,
file = here("lka_linear_me.stan"),
verbose = FALSE,
refresh = 0,
seed = 124)
res <- mod %>%
gather_draws(mu[t]) %>%
median_qi() %>%
mutate(year = years[t])
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res, aes(year, .value)) +
geom_ribbon(data = res, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black")
stan_data <- list(y = lka$logit_ratio, year_i = observed_years - years[1]+1,
T = nyears, years = years, N = length(observed_years),
mid_year = mean(years), se = lka$se, P=9)
mod2 <- stan(data = stan_data,
file = here("lab10_1.stan"),
verbose = FALSE,
refresh = 0,
seed = 124)
res2 <- mod2 %>%
gather_draws(mu[t]) %>%
median_qi() %>%
mutate(year = years[t])
res_p2 <- mod2|>
gather_draws(mu_p[p])|>
median_qi()|>
mutate(year = years[nyears]+p)
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res2, aes(year, .value)) +
geom_ribbon(data = res2, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p2, aes(year, .value), col = "red") +
geom_ribbon(data = res_p2, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res2, aes(year, .value)) +
geom_ribbon(data = res2, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p2, aes(year, .value), col = "red") +
geom_ribbon(data = res_p2, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black, Projection shown in red")
mod3 <- stan(data = stan_data,
file = here("lab10_2.stan"),
verbose = FALSE,
refresh = 0,
seed = 124)
res3 <- mod3 %>%
gather_draws(mu[t]) %>%
median_qi() %>%
mutate(year = years[t])
res_p3 <- mod3|>
gather_draws(mu_p[p])|>
median_qi()|>
mutate(year = years[nyears]+p)
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res3, aes(year, .value)) +
geom_ribbon(data = res3, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p3, aes(year, .value), col = "red") +
geom_ribbon(data = res_p3, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res3, aes(year, .value)) +
geom_ribbon(data = res3, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p3, aes(year, .value), col = "red") +
geom_ribbon(data = res_p3, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "First order random walk fit shown in black, projection in red")
mod4 <- stan(data = stan_data,
file = here("lab10_3.stan"),
verbose = FALSE,
refresh = 0,
seed = 124)
res4 <- mod4 %>%
gather_draws(mu[t]) %>%
median_qi() %>%
mutate(year = years[t])
res_p4 <- mod4|>
gather_draws(mu_p[p])|>
median_qi()|>
mutate(year = years[nyears]+p)
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res4, aes(year, .value)) +
geom_ribbon(data = res4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p4, aes(year, .value), col = "red") +
geom_ribbon(data = res_p4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res4, aes(year, .value)) +
geom_ribbon(data = res4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p4, aes(year, .value), col = "red") +
geom_ribbon(data = res_p4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Second order random walk fit shown in black, Projection in red")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res2, aes(year, .value)) +
geom_ribbon(data = res2, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p2, aes(year, .value)) +
geom_ribbon(data = res_p2, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res3, aes(year, .value), col = "red") +
geom_ribbon(data = res3, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
geom_line(data = res_p3, aes(year, .value), col = "red") +
geom_ribbon(data = res_p3, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
geom_line(data = res4, aes(year, .value), col = "blue") +
geom_ribbon(data = res4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
geom_line(data = res_p4, aes(year, .value), col = "blue") +
geom_ribbon(data = res_p4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black, First order random walk in ")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res2, aes(year, .value)) +
geom_ribbon(data = res2, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p2, aes(year, .value)) +
geom_ribbon(data = res_p2, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res3, aes(year, .value), col = "red") +
geom_ribbon(data = res3, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
geom_line(data = res_p3, aes(year, .value), col = "red") +
geom_ribbon(data = res_p3, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
geom_line(data = res4, aes(year, .value), col = "blue") +
geom_ribbon(data = res4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
geom_line(data = res_p4, aes(year, .value), col = "blue") +
geom_ribbon(data = res_p4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black, First order random walk in red, Second order random walk in blue")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res2, aes(year, .value)) +
geom_ribbon(data = res2, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "black")+
geom_line(data = res_p2, aes(year, .value)) +
geom_ribbon(data = res_p2, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res3, aes(year, .value), col = "red") +
geom_ribbon(data = res3, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
geom_line(data = res_p3, aes(year, .value), col = "red") +
geom_ribbon(data = res_p3, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
geom_line(data = res4, aes(year, .value), col = "blue") +
geom_ribbon(data = res4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
geom_line(data = res_p4, aes(year, .value), col = "blue") +
geom_ribbon(data = res_p4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black, First order random walk in red, Second order random walk in blue")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res2, aes(year, .value)) +
geom_ribbon(data = res2, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "black")+
geom_line(data = res_p2, aes(year, .value)) +
geom_ribbon(data = res_p2, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "black")+
geom_line(data = res3, aes(year, .value), col = "red") +
geom_ribbon(data = res3, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
geom_line(data = res_p3, aes(year, .value), col = "red") +
geom_ribbon(data = res_p3, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
geom_line(data = res4, aes(year, .value), col = "blue") +
geom_ribbon(data = res4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
geom_line(data = res_p4, aes(year, .value), col = "blue") +
geom_ribbon(data = res_p4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black, First order random walk in red, Second order random walk in blue")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res2, aes(year, .value)) +
geom_line(data = res_p2, aes(year, .value)) +
geom_line(data = res3, aes(year, .value), col = "red") +
geom_line(data = res_p3, aes(year, .value), col = "red") +
geom_line(data = res4, aes(year, .value), col = "blue") +
geom_line(data = res_p4, aes(year, .value), col = "blue") +
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res2, aes(year, .value)) +
geom_line(data = res_p2, aes(year, .value)) +
geom_line(data = res3, aes(year, .value), col = "red") +
geom_line(data = res_p3, aes(year, .value), col = "red") +
geom_line(data = res4, aes(year, .value), col = "blue") +
geom_line(data = res_p4, aes(year, .value), col = "blue") +
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black, First order random walk in red, Second order random walk in blue")
lka2 <- lka|>
filter(source!="VR")
observed_years2 <- lka2$year
years2 <- min(observed_years2):max(observed_years2)
nyears2 <- length(years2)
stan_data2 <- list(y = lka2$logit_ratio, year_i = observed_years2 - years2[1]+1,
T = nyears2, years = years2, N = length(observed_years2),
mid_year = mean(years2), se = lka2$se, P=18)
mod5 <- stan(data = stan_data2,
file = here("lab10_3.stan"),
verbose = FALSE,
refresh = 0,
seed = 124)
res5 <- mod5 %>%
gather_draws(mu[t]) %>%
median_qi() %>%
mutate(year = years2[t])
res_p5 <- mod5|>
gather_draws(mu_p[p])|>
median_qi()|>
mutate(year = years2[nyears2]+p)
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res5, aes(year, .value)) +
geom_ribbon(data = res5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p5, aes(year, .value), col = "red") +
geom_ribbon(data = res_p5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Linear fit shown in black")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res5, aes(year, .value)) +
geom_ribbon(data = res5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2)+
geom_line(data = res_p5, aes(year, .value), col = "red") +
geom_ribbon(data = res_p5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Second order random walk fit in black, Projection in red")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res4, aes(year, .value), col = "blue") +
geom_ribbon(data = res4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
geom_line(data = res_p4, aes(year, .value), col = "blue") +
geom_ribbon(data = res_p4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
geom_line(data = res5, aes(year, .value), col = "red") +
geom_ribbon(data = res5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
geom_line(data = res_p5, aes(year, .value), col = "red") +
geom_ribbon(data = res_p5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Model with VR in blue, without VR in red")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res4, aes(year, .value), col = "blue") +
geom_ribbon(data = res4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
geom_line(data = res_p4, aes(year, .value), col = "blue") +
geom_ribbon(data = res_p4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
geom_line(data = res5, aes(year, .value), col = "red") +
geom_ribbon(data = res5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
geom_line(data = res_p5, aes(year, .value), col = "red") +
geom_ribbon(data = res_p5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Model with VR in blue, without VR in red")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res4, aes(year, .value), col = "blue") +
geom_line(data = res_p4, aes(year, .value), col = "blue") +
geom_line(data = res5, aes(year, .value), col = "red") +
geom_line(data = res_p5, aes(year, .value), col = "red") +
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Model with VR in blue, without VR in red")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res4, aes(year, .value), col = "blue") +
geom_ribbon(data = res4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
geom_line(data = res5, aes(year, .value), col = "red") +
geom_ribbon(data = res5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Model with VR in blue, without VR in red")
ggplot(lka, aes(year, logit_ratio)) +
geom_point(aes( color = source)) +
geom_line(aes( color = source), lty = 2) +
geom_ribbon(aes(ymin = logit_ratio - se,
ymax = logit_ratio + se,
fill =  source), alpha = 0.1) +
theme_bw()+
geom_line(data = res4, aes(year, .value), col = "blue") +
geom_ribbon(data = res4, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "blue")+
geom_line(data = res5, aes(year, .value), col = "red") +
geom_ribbon(data = res5, aes(y = .value, ymin = .lower, ymax = .upper), alpha = 0.2, fill = "red")+
theme_bw()+
labs(title = "Ratio of neonatal to other child mortality (logged), Sri Lanka",
y = "log ratio", subtitle = "Model with VR in blue, without VR in red")
